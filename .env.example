# ============================================================================
# Masjid At-Taqwa LMS - Root Environment Configuration
# ============================================================================
# SECURITY: Never commit the actual .env file.
# Copy this file to .env and fill in secure values.
# Generate secrets with: openssl rand -base64 32
# ============================================================================

# ============================================================================
# REQUIRED - Docker Compose and Production Deployment
# ============================================================================

# Database password (PostgreSQL)
POSTGRES_PASSWORD=change-this-to-strong-password

# Strapi Application Keys (comma-separated, generate 4 unique keys)
# Example: openssl rand -base64 24 (run 4 times, join with commas)
APP_KEYS=key1-change-me,key2-change-me,key3-change-me,key4-change-me

# API Token Salt (for Strapi API tokens)
API_TOKEN_SALT=generate-unique-salt-here

# Admin JWT Secret (for Strapi admin authentication)
ADMIN_JWT_SECRET=generate-unique-secret-here

# Transfer Token Salt (for Strapi data transfer)
TRANSFER_TOKEN_SALT=generate-unique-salt-here

# Encryption Key (for sensitive data encryption)
ENCRYPTION_KEY=generate-unique-key-here

# JWT Secret (for user authentication - MUST be same across all services)
JWT_SECRET=generate-unique-secret-here

# ============================================================================
# OPTIONAL - Configuration Overrides
# ============================================================================

# Environment mode
NODE_ENV=production

# Database SSL (enable for production cloud databases)
DATABASE_SSL=false

# API URL (for frontend applications)
NEXT_PUBLIC_API_URL=http://localhost:1337

# ============================================================================
# OPTIONAL - Redis (production caching and rate limiting)
# ============================================================================
# Used by docker-compose.prod.yml for the local Redis container.
REDIS_PASSWORD=change-this-redis-password
REDIS_MAXMEMORY=256mb

# External Redis (if not using Docker Redis)
# UPSTASH_REDIS_URL=
# UPSTASH_REDIS_TOKEN=

# ============================================================================
# OPTIONAL - Ollama AI Service
# ============================================================================
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_MODEL=mistral:7b-instruct-q4_K_M
OLLAMA_EMBED_MODEL=nomic-embed-text
OLLAMA_TIMEOUT_MS=120000
OLLAMA_ENABLED=true
OLLAMA_MAX_PARALLEL=2
OLLAMA_MAX_LOADED_MODELS=1

# Embedding vector dimension (must match OLLAMA_EMBED_MODEL: nomic-embed-text=768, all-minilm=384)
# NOTE: Do NOT use the generation model (mistral) for embeddings. Use a dedicated embedding model.
EMBEDDING_DIMENSION=768

# AI Feature Flags
AI_MODERATION_ENABLED=true
AI_AUTO_MODERATE_ON_CREATE=true
AI_SEARCH_ENABLED=true
AI_RECOMMENDATIONS_ENABLED=true

# AI Rate Limits (per minute)
AI_RATE_LIMIT_AUTHENTICATED=10
AI_RATE_LIMIT_ADMIN=50

# ============================================================================
# OPTIONAL - Caddy Reverse Proxy (production)
# ============================================================================
# Domain for auto-TLS (set to your domain for HTTPS, or localhost for HTTP)
DOMAIN=localhost
CADDY_HTTP_PORT=80
CADDY_HTTPS_PORT=443

# ============================================================================
# OPTIONAL - Monitoring (Grafana, Prometheus, Loki)
# ============================================================================
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin-change-this
GRAFANA_PORT=3300
GRAFANA_ROOT_URL=http://localhost:3300
PROMETHEUS_PORT=9090
LOKI_PORT=3100

# ============================================================================
# OPTIONAL - Backup Configuration
# ============================================================================
# Number of days to retain database backups
BACKUP_RETENTION=30

# ============================================================================
# OPTIONAL - External Services
# ============================================================================
# COOLIFY_TOKEN=  # DO NOT commit - get from Coolify dashboard
# NEXT_PUBLIC_POSTHOG_KEY=
# NEXT_PUBLIC_POSTHOG_HOST=
